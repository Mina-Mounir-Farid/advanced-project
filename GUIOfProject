package com.example.philojx;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Scene;
import javafx.scene.layout.Pane;
import javafx.stage.Stage;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.Arrays;
import javafx.application.Application;
import javafx.geometry.Insets;
import javafx.scene.Scene;
import org.apache.poi.ss.usermodel.Sheet;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;
import javafx.scene.text.Font;
public class HelloApplication extends Application {
        private static ArrayList<VBox> vboxes=new ArrayList<>();
    public static void addVboxes(VBox vboxOfEach){
        vboxes.add(vboxOfEach);

    }
    public VBox MakePanes(FieldsCollection FC){
        //System.out.println("---------------------------------------------------");
        Iterator<Field> field=FC.getFields();
        //System.out.println("---------------------------------------------------");

        VBox vBox=new VBox();
        VBox vBoxGeneral=new VBox();
        while(field.hasNext()){
            //System.out.println("---------------------------------------------------");

            Field EachField=field.next();
            if(field instanceof ObjField objF){
                System.out.println("---------------------------------------------------");
                Button BtObj=new Button(objF.getName());
                BtObj.setOnAction(e->{
                    VBox VboxOfObj=new VBox();
                    Iterator<Field> childs=objF.getFields();
                    while(childs.hasNext()){
                        Field EachChild=childs.next();
                        if (EachChild instanceof StringField EachChildPrint){
                            String StStringField=EachChildPrint.getDirection() + "\t" + EachChildPrint.getName()+ "\t" + "string" +"\t" +Arrays.toString(EachChildPrint.getAllowedVals())+"\t" + (EachChildPrint.isMandatory()?"y":"N");
                            Label lblString=new Label(StStringField);
                            lblString.setFont(new Font("BOLD",16));
                            VboxOfObj.getChildren().add(lblString);
                        }
                        else {
                            String StObjectField=EachChild.getDirection() + "\t" + EachChild.getName() + "\t" + "object" +"\t \t" + (EachChild.isMandatory()?"y":"N");
                            Label lblObject=new Label(StObjectField);
                            lblObject.setFont(new Font("BOLD",16));
                            VboxOfObj.getChildren().add(lblObject);
                        }

                    }
                });
                vBoxGeneral.getChildren().add(BtObj);
                //vBoxGeneral.getChildren().add(vBox);


            }


        }
        vBoxGeneral.setStyle("-fx-background-color: Green ");
                return vBoxGeneral;


    }




    @Override
    public void start(Stage stage) throws IOException {
        BorderPane pane = new BorderPane();
        VBox vBox=new VBox();
        VBox vboxOfbuttoms=new VBox();
        String link = new File("Example.xlsx").getAbsolutePath();

        Iterator<Sheet> iter = sheetReader.read(link);

        Service service = sheetReader.analyse(iter);
        Iterator<Operation> operations = service.getOperations();
        while (operations.hasNext()){
            Operation op = operations.next();
            String StTitle=op.getName() + "\n" + op.get_HTTP_opertion() + "\t" + op.get_REST_URL();
            Label lblTitle=new Label(StTitle);
            lblTitle.setFont(new Font("BOLD",20));
            vBox.getChildren().add(lblTitle);
            vboxOfbuttoms.getChildren().add(MakePanes(op));
        }



        vBox.setStyle("-fx-background-color: yellow ");
        pane.setTop(vBox);

        Scene scene = new Scene(pane, 1000, 500);

        stage.setTitle("CourseProject"); // Set the stage title
        stage.setScene(scene); // Put scene in the stage
        stage.show();
    }


    public static void main(String[] args) {
        launch();
    }
}
